FROM base_icml:1.1.0002

COPY install_WebSphere.xml /tmp/websphere/response
COPY response.websphere.NotManaged /tmp/websphere/response
COPY start_was.sh /root/start.sh

RUN /opt/IBM/InstallationManager/eclipse/tools/imcl -acceptLicense \
   input /tmp/websphere/response/install_WebSphere.xml \
  -log /root/install_log$(date +%s).xml -showProgress \
  -preferences com.ibm.cic.common.core.preferences.ssl.nonsecureMode=true
RUN /opt/IBM/WebSphere/AppServer/bin/manageprofiles.sh \
  -response /tmp/websphere/response/response.websphere.NotManaged

RUN groupadd -g 18002 wasgrp \
&& useradd -u 18001 -g wasgrp wasadmin

CMD ["/usr/bin/sh", "/root/start.sh"]


# podman build -f Containerfile_WebSphere -t websphere:1.1.0008 .


# sudo mkdir -p /srv/was/logs && mkdir -p /srv/was/apps && mkdir -p /srv/was/profile && sudo chown -R alex:alex /srv/was
# podman volume create -o device=/srv/ihs/logs -o=o=bind ihs_logs_vol


# podman run -d --rm -v wasrepo_vol:/var/local:Z -p 9043:9043 -p 9060:9060 -p 9080:9080 -p 9443:9443 --name websphere localhost/websphere:1.1.0008



